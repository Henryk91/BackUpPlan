{% extends "layout.html" %}

{% block title %}
    Home
{% endblock %}

{% block main %}
    {% if message %}
        <div class="alert alert-primary border text-center" role="alert">
            {{ message }}
        </div>
    {% endif %}
    <h3>Currrent Time: {{ time_now }} </h3>
    <h3>Active Plans</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Start Time</th>
                <th>Name</th>
                <th>Time Interval</th>
                <th>Next Expiration</th>
                <th>Remaining Time</th>
                <th>Notify Time</th>
                <th>Stop Time</th>
                <th><a href="/">Reload Time</a></th>
                {% if reminders[0]['share_count']  %}
                    <th>Other</th>
                {% endif %}
            </tr>
        </thead>
        <tfoot>
            <tr>
                <td colspan="4"></td>
                <td><strong>{{total}}</strong></td>
            </tr>
        </tfoot>
        <tbody>
                {% for reminder in reminders %}
                    {% if reminder['start_time']  %}
                            <tr>
                                <td>{{ reminder['start_time'] }}</td>
                                <td>{{ reminder['name'] }}</td>
                                <td>{{ reminder['interval'] }} min</td>
                                <td>{{ reminder['next_expiration'] }}</td>
                                {% if reminder['runout']  %}
                                    <td style="color:red;">{{ reminder['remaining_time'] }} Late</td>
                                {% else  %}
                                    <td>{{ reminder['remaining_time'] }}</td>
                                {% endif %}
                                <td>{{ reminder['notify_time'] }}</td>
                                <td>{{ reminder['end_time'] }}</td>
                            <td>
                                <a href="/plan?id={{ reminder['id'] }}">Details</a><br />
                                {% if reminder['end_time'] == None  %}
                                    {% if reminder['notify_time'] == None  %}
                                        <a href="/?checkin={{ reminder['id'] }}">Check in</a><br />
                                    {% endif  %}
                                    <a href="/?stop={{ reminder['id'] }}">Stop</a><br />
                                {% endif  %}

                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
        </tbody>
    </table>
{% endblock %}
